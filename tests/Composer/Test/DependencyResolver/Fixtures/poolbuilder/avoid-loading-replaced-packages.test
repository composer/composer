--TEST--
Do not load replaced packages into the pool unless they are required elsewhere

--REQUEST--
{
    "require": {
        "root/req1": "*"
    },
    "locked": [
        {"name": "root/req1", "version": "1.0.0", "require": {"replacer/pkg": "1.*"}},
        {"name": "replacer/pkg", "version": "1.0.0", "replace": {"replaced/pkg": "*"}}
    ],
    "allowList": [
        "root/req1"
    ],
    "allowTransitiveDeps": true
}

--FIXED--
[
]

--PACKAGE-REPOS--
[
    [
        {"name": "root/req1", "version": "1.0.0", "require": {"replacer/pkg": "1.*"}},
        {"name": "root/req1", "version": "1.1.0", "require": {"replacer/pkg": "1.*"}},
        {"name": "replacer/pkg", "version": "1.0.0", "replace": {"replaced/pkg": "*"}},
        {"name": "replacer/pkg", "version": "1.1.0", "replace": {"replaced/pkg": "*"}},
        {"name": "replaced/pkg", "version": "1.2.3"},
        {"name": "replaced/pkg", "version": "1.2.4"}
    ]
]

--EXPECT--
[
    "root/req1-1.0.0.0",
    "root/req1-1.1.0.0",
    "replacer/pkg-1.0.0.0",
    "replacer/pkg-1.1.0.0"
]

--EXPECT-OPTIMIZED--
[
    "root/req1-1.1.0.0",
    "replacer/pkg-1.1.0.0"
]
